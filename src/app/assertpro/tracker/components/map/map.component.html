<style>
  #map {
    top: 79px;
    bottom: 0;
    width: 100%;
    /* height:88vh; */
  }

  .calculation-box {
    height: 75px;
    width: 150px;
    position: absolute;
    bottom: 40px;
    left: 10px;
    background-color: rgba(255, 255, 255, .9);
    padding: 15px;
    text-align: center;
  }

  p {
    font-family: 'Open Sans';
    margin: 0;
    font-size: 13px;
  }
</style>
<ngx-spinner bdColor="rgba(53,53,53, 0)" size="medium" color="#25242475" type="ball-clip-rotate-multiple">
</ngx-spinner>
<div class="container-fluid">
  <div class="map" id="map" [ngClass]="{'full-screen':Isfullscreen?true:false,'half-screen':!Isfullscreen}"></div>
</div>
<div *ngIf="!openTimeline">
  <div *ngIf="menutype =='history'"
    style="width:10%;height:20px;position:fixed;z-index:999;background-color:white;bottom:10%;right:1%;margin-bottom:21px">
    <div class="container">
      <div class="col-9">
        <div class="text-right color-show-txt" (click)="showTimeLine()"><span
            style="position:absolute;margin-left:-28px"><img style="height: 15px; width:16px;"
              src="assets/icon/open.png"></span>Show</div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="!isChangeDateClicked ">
  <div *ngIf="menutype =='history'"
    style="width:34%;height:230px;position:fixed;z-index:999;bottom:10%;right:1%;margin-bottom:21px">
    <div style="background-color:white;cursor: move;" cdkDrag>
      <div class="container-fluid">
        <div class="row" style="padding-left:18px;padding-top:15px">
          <div class="col-10" style="padding:0;">
            <div class="row" style="padding-left: 15px;">
            <div class="text-left time-line-txt">
              TIMELINE
              
              <!-- <input type="button" (click)="playAndPause()" value="{{playEnable?'Pause':'Play'}}"> -->
            </div>
            <!-- <mat-icon (click)="playAndPause()"  style="margin-top: -1%;cursor: pointer;" aria-hidden="false" aria-label="Play/Pause">{{playEnable?'pause_circle_filled':'play_circle_fill'}}</mat-icon> -->
            <div style="padding:1px;padding-left:7px;" class="text-left date-time-timeline ">{{StartDate}}-{{EndDate}}</div>
          </div>
          </div>
          <!--  <div class="col-8" style="padding: 0;">
            <div class="text-left date-time-timeline ">{{StartDate}}-{{EndDate}}</div>
           <span>{{uniqueOperatorNames}}</span>
          </div> -->
          <div class="col-2">
            <div class="text-right color-show-txt" style="margin-right:6px" (click)="showDate()">
              Change
            </div>
          </div>
        </div>
        <div class="row" style="padding:0;padding-left:11px;margin-top:8px">
          <div class="col-5" style="padding:0;">
            <div class="col-12" style="padding:0;">
              <div class="text-left time-asset-txt">
                <div class="btn-group" dropdown #dropdown="bs-dropdown" [autoClose]="true">
                  <div (mouseenter)="DrawHistoryMarkarPin(asset,false)" dropdownToggle
                    style="cursor:pointer;border:1px solid #169bd7;border-radius: 25px;padding:10px;padding-top:5px;padding-bottom:5px">
                    {{slectedhistorydetails?.OperatorName}}
                    {{slectedhistorydetails.AssetType!=undefined?slectedhistorydetails.AssetType+'/':''}}{{slectedhistorydetails.AssetName}}<span
                      style="float:right;margin-left:10px"><img src="assets/icon/dropdown-light.png"></span>
                  </div>

                  <ul *dropdownMenu role="menu" class="dropdown-menu asset-drop-down">
                    <div *ngFor="let currenthistory of currenthistorydetails" class="asset-dropdown-li">
                      <div class="time-asset-txt" (click)="getTimeLineIndividualResult(currenthistory)"
                        [ngClass]="{'active-asset': timelineselected==currenthistory.AssetName}">
                        {{currenthistory?.OperatorName}}
                        {{currenthistory.AssetType!=undefined?currenthistory.AssetType+'/':''}}{{currenthistory.AssetName}}
                      </div>
                    </div>
                  </ul>
                </div>
              </div>
            </div>
            <div class="col-12" style="padding:0;padding-left:3%;margin-top: 10px;padding-bottom: 4%;">
              <div class="text-left impact-del-txt" *ngIf="historydatadetilas.dectectName=='Impact'">
                Detected:Impact
              </div>
              <div class="text-left impact-nor-txt" *ngIf="historydatadetilas.dectectName!='Impact'">
                Detected:{{this.historydatadetilas.dectectName}}
              </div>

            </div>
          </div>
          <div class="col-7">
            <div class="row">
              <div class="col-10">
                <div *ngIf="showPopup" class="row">
                  <div class="col-4 time-line-txt">
                    Alarm:
                  </div>
                  <div class="col-8">
                    <div class="text-left impact-del-txt" style="white-space: nowrap;"
                      *ngIf="timeData?.EventName=='Impact Alarm' || timeData?.EventName=='Overweight Alarm' || timeData?.EventName=='Speed Alarm'">
                      {{timeData?.EventName}}
                    </div>
                    <div class="text-left impact-nor-txt" style="white-space: nowrap;"
                      *ngIf="timeData?.EventName!='Impact Alarm' &&  timeData?.EventName!='Overweight Alarm' && timeData?.EventName!='Speed Alarm'">
                      {{timeData?.EventName}}
                    </div>

                  </div>
                </div>
                <div *ngIf="showPopup" class="row">
                  <div class="col-4 time-line-txt">
                    Mode:
                  </div>
                  <div class="col-8 date-time-timeline" style="white-space: nowrap;">
                    {{timeData?.modeName}}
                  </div>
                </div>
                <div *ngIf="showPopup" class="row">
                  <div class="col-4 time-line-txt">
                    Operator:
                  </div>
                  <div class="col-8 color-show-txt" style="white-space: nowrap;">
                    {{timeData?.OperatorName}}
                  </div>
                </div>
                <div *ngIf="showPopup" class="row">
                  <div class="col-4 time-line-txt">
                    Time:
                  </div>
                  <div class="col-8 date-time-timeline" style="white-space: nowrap;">
                    {{timeData?.DATE}}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row" style="padding:0;padding-left:18px;margin-top:11px;">
          <div class="col-4" style="padding:0;">
            <div class="text-left date-time-timeline">
              {{StartDate}}
            </div>
          </div>
          <div class="col-2">

          </div>
          <div class="col-6">
            <div class="text-right date-time-timeline" style="margin-right:6px">
              {{EndDate}}
            </div>
          </div>
        </div>
        <div class="row" id="timeline-scroll"
          style="padding-top:150px;margin-left:0px;padding-bottom:8px;margin-top:-140px;max-width: 100%;overflow-x: auto;flex-wrap: nowrap">
          <div *ngFor="let asset of CurrentassetHistory; let i = index;" style="cursor: pointer;">
            <div class="btn-group" dropdown #dropdown="bs-dropdown" [autoClose]="true">
              <div *ngIf="asset!=undefined && (!asset.edited || asset.edited==undefined) && asset.space==undefined"
                (mouseenter)="DrawHistoryMarkarPin(asset,true)" (click)="timelinePopup(i,asset)" class="time-line"
                [ngbPopover]="popContent"
                [ngClass]="[asset.ColorCode=='normal'? 'normal-time-line' : '',asset.ColorCode=='loaded'? 'loaded-time-line' : '',asset.ColorCode=='idle'? 'idel-time-line' : '',asset.ColorCode=='accident'? 'accident-time-line' : '']"
                (mouseleave)="showPopup=false">

              </div>
              <div *ngIf="asset.space==true" style="background-color:white;width:50px"></div>
              <div id="new{{i}}" *ngIf="asset!=undefined && asset.edited" class="time-line2"
                (mouseenter)="DrawHistoryMarkarPin(asset,true)" [ngbPopover]="popContent"
                (mouseleave)="showPopup=false"></div>
              <div class="vertical-hr" *ngIf="asset.IsOperatorChanged"></div>
              <div class="dis">
                <p>&#8592;{{CurrentassetHistory[i]?.operatorName}}</p>
                <p>{{CurrentassetHistory[i+1]?.OperatorName}} &#8594;</p>
              </div>

              <div *ngIf="asset==undefined" class="time-line">
              </div>
            </div>
          </div>
        </div>
        <div class="row" *ngIf="showcolorcode==true" style="padding:0;padding-left:18px;margin-top:15px">
          <div class="col-3" style="padding:0;">
            <div class="text-left color-show-txt" (click)="showcolorcode=!showcolorcode">
              Hide color coding < </div> </div> <div class="col-auto"
                style="padding:0;padding-left:20px;margin-top:-3px">
                <div class="text-left">
                  <span class="normal-code-circle"></span> <span class="color-code-texts">Usage</span>
                </div>
            </div>
            <div class="col-auto" style="padding:0;padding-left:20px;margin-top:-3px">
              <div class="text-left">
                <span class="loaded-code-circle"></span> <span class="color-code-texts">Loaded</span>
              </div>
            </div>
            <div class="col-auto" style="padding:0;padding-left:20px;margin-top:-3px">
              <div class="text-left">
                <span class="idel-code-circle"></span> <span class="color-code-texts">Standby</span>
              </div>
            </div>
            <div class="col-auto" style="padding:0;padding-left:20px;margin-top:-3px">
              <div class="text-left">
                <span class="accident-code-circle"></span> <span class="color-code-texts">Alarm</span>
              </div>
            </div>
          </div>
          <div class="row" *ngIf="showcolorcode==false" style="padding:0;padding-left:18px;margin-top:15px">
            <div class="col-3" style="padding:0;">
              <div class="text-left color-show-txt" (click)="showcolorcode=!showcolorcode">
                Show color coding >
              </div>
            </div>
            <div class="col-9">
              <div class="text-right cancel-btn" (click)="closeTimeline()">
                <span style="position:absolute;margin-left:-18px;color:#169bd7">
                  <!-- <img src="assets/icon/geo-cancel.png"> -->
                  <p>&#8594;</p>
                </span><span style="color:#169bd7">Hide</span>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>






  <div class="map-tool-bar">
    <div class="row">
      <div class="col-3">
        <div class="navigation-control" (click)="FullScreen()" *ngIf="!Isfullscreen && !satellitetype">
          <img src="assets/icon/fullscreen.png" onmouseover="this.src='assets/icon/fullscreen-active.png'"
            onmouseout="this.src='assets/icon/fullscreen.png'">
        </div>
        <div class="navigation-control" (click)="FullScreen()" *ngIf="!Isfullscreen && satellitetype">
          <img src="assets/icon/fullscreen2.png" onmouseover="this.src='assets/icon/fullscreen-active.png'"
            onmouseout="this.src='assets/icon/fullscreen2.png'">
        </div>
        <div class="navigation-control" (click)="FullScreen()" *ngIf="Isfullscreen">
          <img src="assets/icon/fullscreen-active.png">
        </div>
      </div>
      <div class="col-2">
        <div class="navigation-control" (click)="ZoomOut()">
          <img *ngIf="satellitetype" src="assets/icon/zoom-out2.png"
            onmouseover="this.src='assets/icon/zoom-out-active.png'" onmouseout="this.src='assets/icon/zoom-out2.png'">
          <img *ngIf="!satellitetype" src="assets/icon/zoom-out.png"
            onmouseover="this.src='assets/icon/zoom-out-active.png'" onmouseout="this.src='assets/icon/zoom-out.png'">
        </div>

      </div>
      <div class="col-2">
        <div class="navigation-control" (click)="ZoomIn()">
          <img *ngIf="satellitetype" src="assets/icon/zoom-in2.png"
            onmouseover="this.src='assets/icon/zoom-in-active.png'" onmouseout="this.src='assets/icon/zoom-in2.png'">
          <img *ngIf="!satellitetype" src="assets/icon/zoom-in.png"
            onmouseover="this.src='assets/icon/zoom-in-active.png'" onmouseout="this.src='assets/icon/zoom-in.png'">
        </div>

      </div>
      <div class="col-2" *ngIf="createMode || startEditMode">
        <div (click)="DrawToolAction()">
          <img *ngIf="!Isdrawtoolactive && satellitetype" src="assets/icon/edit-btn2.png"
            onmouseover="this.src='assets/icon/edit-btn-active.png'" onmouseout="this.src='assets/icon/edit-btn2.png'">
          <img *ngIf="!Isdrawtoolactive && !satellitetype" src="assets/icon/edit-btn.png"
            onmouseover="this.src='assets/icon/edit-btn-active.png'" onmouseout="this.src='assets/icon/edit-btn.png'">
          <img *ngIf="Isdrawtoolactive" src="assets/icon/edit-btn-active.png">

        </div>
      </div>
      <div class="col-2" style="cursor: pointer">
        <div (click)="setSatelliteView()">
          <img *ngIf="!satellitetype" src="assets/icon/satellite.png"
            onmouseover="this.src='assets/icon/satelliteactive.png'" onmouseout="this.src='assets/icon/satellite.png'">
          <img *ngIf="satellitetype" src="assets/icon/satelliteactive.png">
        </div>
      </div>
    </div>
  </div>






  <div *ngIf="editMode && startEditMode" class="delete-gefence" (click)="DeleteGeofence()">
    <div class="text-center">
      DELETE GEOFENCE
    </div>
  </div>

  <div id="style-5" *ngIf="(editMode && startEditMode) || createMode" class="geofence-container-box"
    [ngClass]="[IsEditgeofence ? 'edit-add-con' : '']">
    <div class="sub-geofence-container">
      <div class="geofence-container">

        <div class="row">
          <div class="col-6">
            <div *ngIf="startEditMode" class="text-left geofence-label">
              EDIT GEOFENCE DATA
            </div>
            <div *ngIf="createMode" class="text-left geofence-label">
              CREATE GEOFENCE
            </div>

          </div>
          <div class="col-3">
            <div class="text-right cancel-btn" (click)="cancelgeofence()"><span
                style="position:absolute;margin-left:-18px"><img src="assets/icon/geo-cancel.png"></span>Cancel</div>
          </div>
          <div class="col-3">
            <div class="text-right geofence-add" (click)="SaveGeofence()"><span
                style="position:absolute;margin-left:-20px;margin-top:-2px"><img
                  src="assets/icon/tick-apply.png"></span><span *ngIf="!IsEditgeofence">Submit</span>
              <span *ngIf="IsEditgeofence">Apply</span>
            </div>
          </div>
        </div>
      </div>
      <div class="unique-container">
        <div class="row">
          <div class="col-6">
            <div class="text-left select-geofence">
              *ENTER UNIQUE NAME
            </div>
          </div>
        </div>
      </div>
      <div class="geofence-dropdownbtn-container">
        <div class="row unique-input-box-container">
          <input type="text" class="unique-input-box" [(ngModel)]="geofencename">
        </div>
      </div>
      <div class="asign-site">
        <div class="row">
          <div class="col-6">
            <div class="text-left select-geofence">
              *ASSIGN TO THE SITE
            </div>
          </div>
        </div>
      </div>
      <div class="container geofence-dropdownbtn-container">
        <div class="row geofence-dropdownbtn">
          <div class="btn-group" dropdown #dropdown="bs-dropdown" [autoClose]="true" [isDisabled]="IsEditgeofence">
            <a dropdownToggle class="select-drop-item" style="cursor: pointer">
              {{selectdropdownitem}}
              <span style="position: absolute;right:0;bottom:2px;margin-bottom: 2%;"><img
                  src="assets/icon/dropdown-teal-ic.png"></span>
            </a>
            <ul id="style-5" *dropdownMenu class="dropdown-menu" role="menu"
              style="width:285px;padding-left:20px;margin-top:10px;border:1px solid #d4f2ff;height:300px;overflow-x: hidden;overflow-y:scroll;">
              <li *ngFor="let site of usersites">
                <span *ngIf="site.Name!='All Sites'" class="assettype-txt" style="cursor:pointer"
                  (click)="SelectSiteMenu(site)">{{site.Name}}</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="assign-asset-container">
        <div class="row">
          <div class="col-6">
            <div class="text-left select-geofence">
              *ASSIGN ASSET
            </div>
          </div>
          <div class="col-6">
            <div class="text-right geofence-add" (click)="clearAllasset()">Clear all</div>
          </div>
        </div>
      </div>
      <div class="container tree-box-container ">
        <div class="tree-box">
          <div id="style-5" class="search-btn">
            <div class="row">
              <div class="col-auto" style="padding-left:10px;padding-right:0px" *ngFor="let bubble of bubbles">
                <div class="bubbles bubbles-txt">{{bubble.value}}
                  <a (click)="RemoveFilterItem(bubble)" style="margin-left:10px;cursor: pointer;">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14px"
                      version="1.1" height="14px" viewBox="0 0 64 64" enable-background="new 0 0 64 64">
                      <g>
                        <path fill="#FFFFFF"
                          d="M28.941,31.786L0.613,60.114c-0.787,0.787-0.787,2.062,0,2.849c0.393,0.394,0.909,0.59,1.424,0.59   c0.516,0,1.031-0.196,1.424-0.59l28.541-28.541l28.541,28.541c0.394,0.394,0.909,0.59,1.424,0.59c0.515,0,1.031-0.196,1.424-0.59   c0.787-0.787,0.787-2.062,0-2.849L35.064,31.786L63.41,3.438c0.787-0.787,0.787-2.062,0-2.849c-0.787-0.786-2.062-0.786-2.848,0   L32.003,29.15L3.441,0.59c-0.787-0.786-2.061-0.786-2.848,0c-0.787,0.787-0.787,2.062,0,2.849L28.941,31.786z" />
                      </g>
                    </svg>
                  </a>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-10">
                <input type="text" style="width:100%;border:none;outline: none;margin-top:2px"
                  placeholder="Enter the name of the asset...." [(ngModel)]="searchText">
              </div>
              <div class="col-2">
                <div class="text-text">
                  <img src="assets/icon/icon-search.png" style="height:15px;margin-top:5px">
                </div>
              </div>
            </div>
          </div>
          <div id="style-5" class="asset-container">
            <div *ngFor="let assetstype of assets|search : searchText">
              <a style="cursor:pointer" [attr.aria-expanded]="assetstype.status" aria-controls="collapseBasic">
                <img *ngIf="!assetstype.status" (click)="assetstype.status = !assetstype.status"
                  src="assets/common/assetplus.png">
                <img *ngIf="assetstype.status" (click)="assetstype.status = !assetstype.status"
                  src="assets/common/assetminus.png">
                <span class="assettype-txt"
                  (click)="AssignAsset(assetstype.assetstype+'/'+'All','assettype',assetstype,assetstype.assetstype)">{{assetstype.assetstype}}</span>
              </a>
              <div id="collapseBasic" [collapse]="!assetstype.status">
                <div *ngFor="let asset of assetstype.assets|subsearch: searchText">
                  <span class="asset-txt" style="cursor: pointer"
                    (click)="AssignAsset(assetstype.assetstype+'/'+asset.name,'asset',asset,asset.AssetTypeName)">{{asset.name}}</span>
                </div>
              </div>
            </div>
          </div>
          <div>
          </div>
        </div>
      </div>

      <div class="start-alarm-container">
        <div class="row">
          <div class="col-auto">
            <div class="text-left select-geofence">
              <div class="btn-group" dropdown>
                START AN ALARM IF <a id="button-basic" dropdownToggle aria-controls="dropdown-basic"
                  style="cursor:pointer;margin-left:5px;margin-right:5px;color:#169bd7">
                  {{selectalarmtype}}
                </a> GEOFENCE
                <ul id="dropdown-basic" *dropdownMenu role="menu" aria-labelledby="button-basic"
                  class="dropdown-menu dropdown-menu-right" style="border:0;">
                  <div style="box-shadow: 0 4px 14px 0 rgba(0, 0, 0, 0.12);width:85px;margin-left:25px;">
                    <div *ngFor="let type of alarmtype">
                      <div class="alarm-txt" style="height:30px"
                        [ngClass]="{'active-alarmmenu':type.name==selectalarmtype}" (click)="selectalarmtype=type.name">
                        {{type.name}}</div>
                    </div>
                  </div>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-auto">
            <div class="text-right" style="margin-left:15px;margin-top:7px">
              <label class="switch" style="outline:none">
                <input type="checkbox" style="outline:none" id="check" name="check" [(ngModel)]="typecheck">
                <span class="slider round" style="outline:none"></span>
              </label>
            </div>
          </div>
        </div>
      </div>
      <div class="notes-container">
        <div class="row">
          <div class="col-6">
            <div class="text-left select-geofence">
              NOTES
            </div>
          </div>
        </div>
        <div style="margin-bottom:5px">
          <textarea style="width:100%;height:70px;border:1px solid #d4f2ff;margin-top:9px;outline:none;"
            [(ngModel)]="notes">





































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































        </textarea>
        </div>
      </div>
    </div>
  </div>


  <div *ngIf="editMode && beforeEditMode"
    style="width:24%;min-height:15.319488817891376vh;background-color: white;position:absolute;right:0;top:0;margin-top:18vh;margin-right:2.9%;">


    <div class="geofence-container" style="margin-top: 3.514377vh">
      <div class="row justify-content-end">
        <div class="col-3">
          <div class="text-right cancel-btn" (click)="cancelEditMode()"><span
              style="position:absolute;margin-left: 10px"><img src="assets/icon/geo-cancel.png"></span></div>
        </div>
      </div>
      <div class="row">
        <div class="col-8">
          <span class="geofence-label">{{singlegeofence.SiteName}}/{{singlegeofence.Name}}</span>
        </div>
        <div class="col-4">
          <div class="text-right geofence-add" (click)="EditGeofence()">
            Edit
          </div>
        </div>
      </div>

      <div *ngIf="!showmoreGeoFenceDetails">
        <div class="row" style="margin-top:20px">
          <div class="col-6">
            <div class="text-left select-geofence">
              ASSIGN ASSET
            </div>
          </div>
        </div>
        <div id="style-5" style="margin-top:15px">
          <div *ngFor="let assetstype of singlegeofence.AssetType">
            <a style="cursor:pointer" [attr.aria-expanded]="assetstype.status" aria-controls="collapseBasic">
              <img *ngIf="!assetstype.status" (click)="assetstype.status = !assetstype.status"
                src="assets/common/assetplus.png">
              <img *ngIf="assetstype.status" (click)="assetstype.status = !assetstype.status"
                src="assets/common/assetminus.png">
              <span class="assettype-txt">{{assetstype.assetstype}}</span>
            </a>
            <div id="collapseBasic" [collapse]="!assetstype.status">
              <div *ngFor="let asset of assetstype.assets">
                <span class="asset-txt" style="cursor: pointer"
                  (click)="AssignAsset(assetstype.assetstype+'/'+asset.name,'asset',asset)">{{asset.name}}</span>
              </div>
            </div>
          </div>
        </div>
        <div class="row" style="margin-top:21px">
          <div class="col-6">
            <div class="text-left select-geofence">
              Notes
            </div>
          </div>
        </div>
        <div class="row" style="margin-top:11px">
          <div class="col-6">
            <div class="text-left notes-txt">
              {{singlegeofence.Notes}}
            </div>
          </div>
        </div>

        <div>
          <div class="row" style="margin-top:20px;margin-bottom:40px">
            <div class="col-auto">
              <div class="text-left alarm-geofence">
                <div class="btn-group" dropdown>
                  START AN ALARM IF <span *ngIf="singlegeofence.Outside==0"
                    style="cursor:pointer;margin-left:5px;margin-right:5px;color:#169bd7">
                    OUT OF
                  </span>
                  <span *ngIf="singlegeofence.Outside!=0"
                    style="cursor:pointer;margin-left:5px;margin-right:5px;color:#169bd7">
                    IN
                  </span>
                  GEOFENCE

                </div>
              </div>
            </div>
            <div class="col-auto">
              <div class="text-right" style="margin-top:7px">
                <label class="switch" style="outline:none">
                  <input type="checkbox" style="outline:none" id="check" name="check" [disabled]="true"
                    [checked]="singlegeofence.Type=='Alarm'">
                  <span class="slider round" style="outline:none"></span>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>


      <div
        style="background-color:#d4f2ff;height:35px;position:absolute;bottom:0;width:100%;margin-left:-10%;cursor:pointer">
        <div class="text-center show-more" *ngIf="showmoreGeoFenceDetails" style="margin-top:10px"
          (click)="showmoreGeoFenceDetails=!showmoreGeoFenceDetails">SHOW
          MORE</div>
        <div class="text-center show-more" *ngIf="!showmoreGeoFenceDetails" style="margin-top:10px"
          (click)="showmoreGeoFenceDetails=!showmoreGeoFenceDetails">HIDE</div>
      </div>
    </div>
    <div>
    </div>
  </div>
  <div bsModal #mapdatemodel="bs-modal" class="modal fade" tabindex="-1" role="dialog"
    aria-labelledby="dialog-sizes-name1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content" style="width:550px;height:470px;margin-top:100px">

        <a class="close " style="margin-right:30px;position:absolute;right:0;margin-top:10px;z-index:99999999999"
          (click)="mapdatemodel.hide()" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </a>
        <div class="modal-body">
          <div class="container-fluid">
            <div class="row">
              <div class="col-4" *ngIf="fromDate">
                <div class="text-center">
                  <img src="assets/icon/calcender.png">
                  <span style="margin-left:10px">{{fromDate.month}}</span>/ <span>{{fromDate.day}}</span>/
                  <span>{{
                    fromDate.year}}</span>
                </div>
              </div>
              <div class="col-4" *ngIf="toDate">
                <div class="text-center">
                  <img src="assets/icon/calcender.png">
                  <span style="margin-left:10px">{{toDate.month}}</span>/<span>{{toDate.day}}</span>/<span>{{
                    toDate.year}}</span>
                </div>
              </div>

            </div>
            <div class="row" style="margin-top:10px;margin-bottom:10px">
              <div class="col-6 assettype-txt">
                Pick Custom Date
              </div>
            </div>
            <div class="row" style="margin-top:1  0px">
              <div class="col-12">
                <div class="text-center">
                  <div>
                    <ngb-datepicker #dp (select)="onDateSelection($event)" [displayMonths]="2" [dayTemplate]="t"
                      outsideDays="hidden">
                    </ngb-datepicker>
                    <!-- <button type="button" (click)="dp.navigateTo({year: 2017, month: 7})">Sample</button> -->
                    <ng-template #t let-date let-focused="focused">
                      <span class="custom-day" [class.focused]="focused" [class.range]="isRange(date)"
                        [class.faded]="isHovered(date) || isInside(date)" (mouseenter)="hoveredDate = date"
                        (mouseleave)="hoveredDate = null">
                        {{ date.day }}
                      </span>
                    </ng-template>
                  </div>

                </div>
              </div>
            </div>
            <div class="row" style="margin-top:10px">
              <div class="col-6 assettype-txt">
                Pick Custom Time
              </div>
            </div>
            <div class="row" style="margin-top:10px">
              <div class="col-5">
                <timepicker [(ngModel)]="historyStartTime" [showSpinners]="false"></timepicker>
              </div>
              <div class="col-5">
                <timepicker [(ngModel)]="historyEndTime" [showSpinners]="false"></timepicker>
              </div>
              <div class="col-2">
                <div class="time-save-btn" (click)="getTimeLineResult()">
                  <div class="text-center">Save</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>